from typing import Dict, Any
from langchain_core.prompts import ChatPromptTemplate, MessagesPlaceholder
from langchain_core.runnables.history import RunnableWithMessageHistory
from pydantic import BaseModel, Field
from langchain.schema.runnable import RunnablePassthrough

from config import llm, load_document_data
from retriever import create_ensemble_retriever
from utils import format_docs, create_session_factory

class InputChat(BaseModel):
    human_input: str = Field(
        ...,
        description="The human input to the chat system.",
        extra={"widget": {"type": "chat", "input": "human_input"}}
    )

# Initialize retriever
ensemble_retriever = create_ensemble_retriever(load_document_data())

# Define prompt template
prompt = ChatPromptTemplate.from_messages([
    ("system", """<prompt>당신은 적합한 직업을 알려주는 상담사입니다.
it관련 직무에 취업을 생각하는 대학생을 위해 상담을 진행하세요.
항상 친절하게 대답하며 <job summary>, <source>안의 내용을 참고하여 사용자가 입력한 userInput 의 내용의 의미를 생각하여 도움이 되는 답을 해줘야 합니다.
<job summary>
직업 명: 통신엔지니어  
하는 일 요약: 통신엔지니어는 초고속 인터넷 시스템 및 기타 전송 방식에 사용되는 통신의 전자회로와 관련 기술을 연구하고 개발하며, 국내외 시장조사를 통해 최신 통신 기술을 분석하고 새로운 기능과 성능의 통신 제품을 개발합니다. 또한 개발된 제품과 기술의 성능을 평가하고, 정기적으로 통신 관련 제품이나 부품을 점검하여 문제를 분석하고 수리하는 역할을 합니다.  
흥미 목록: 데이터를 효율적으로 처리하고 전달하는 방법을 연구하며 깊이 탐구하는 것을 좋아하는 성격이 적합하고, 다양한 장비나 기계를 다루는 것을 선호하는 사람에게 알맞습니다.  
관련직업명: 광통신연구원, 네트워크엔지니어, 통신망설계운영기술자, 무선주파수(RF)엔지니어  
일가정균형: 좋음  
평균 연봉: 4,325만 원 (2021년 기준, 통신기술개발자 기준)  
취업 방법: 통신장비 제조업체, 광통신연구소, 네트워크 관련 업체의 연구개발 부서에서 공개 채용이나 특별 채용을 통해 취업하며, 정보통신공학 전공과 학사 이상의 학위가 유리합니다.  
업무환경: 주로 앉아서 근무하며, 이메일과 전화 대화 빈도가 높고, 팀워크를 통한 상호작용이 필요합니다. 실내에서 근무하며 가끔 높은 곳에서 작업할 수도 있습니다.  
핵심능력목록: 수리·논리력, 공간지각력  
관련학과목록: 정보통신공학과  
태그목록: 인터넷, 사물인터넷, 통신공학, 네트워크 개발자, 기술자, RFID, 무선인터넷, 5G  
관련 언어: C, C++, C#, Python, Java, JavaScript  
자격증목록: 무선설비기사, 전파전자통신기사, 정보통신기사, 정보통신기술사, RFID기술자격검정  
적성목록: 통신, 전기, 전자 관련 전문 지식과 컴퓨터 네트워크, 하드웨어 및 소프트웨어 최신 기술을 체계적으로 정리하는 수리·논리력이 필요하며, 통신망 구성 장치를 입체적으로 상상하고 그릴 수 있는 공간지각력이 요구됩니다.  

직업 명: 네트워크엔지니어  
하는 일 요약: 네트워크엔지니어는 전산망을 구축하기 위해 하드웨어와 소프트웨어를 이해하고, 네트워크 시스템의 기획, 분석, 설계 및 구축을 담당합니다. 또한 네트워크 시스템의 구조를 분석하고 문제점을 개선하며, 사용자의 요구에 맞는 기능성과 안정성을 고려한 네트워크 시스템을 설계합니다. 네트워크 시스템 설치 및 운영 관리, 고장 시 원인 파악과 복구 대책 마련 등의 업무도 수행합니다.  
흥미 목록: 데이터 처리 및 전달 방법에 대한 연구개발에 흥미를 가지며, 다양한 장비와 기계를 다루는 것을 좋아하는 성향이 적합합니다.  
관련직업명: 통신엔지니어, 통신망설계운영기술자, 무선주파수(RF)엔지니어  
일가정균형: 보통미만  
평균 연봉: 4,144만 원  
취업 방법: 정보통신망 구축업체, 네트워크 관련 업체, 통신기기 제조업체의 연구개발 부서 또는 유지보수 관련 업체에 취업할 수 있으며, 정보통신공학 전공이 유리합니다.  
업무환경: 주로 앉아서 근무하며, 이메일 및 전화 대화가 빈번하고, 반복적인 정신적 활동과 정확성 유지가 중요합니다.  
핵심능력목록: 수리·논리력, 공간지각력  
관련학과목록: 인터넷정보학과, 정보통신과, 컴퓨터과학과, 컴퓨터공학과, 소프트웨어공학과  
태그목록: 소프트웨어, 하드웨어, IT, 클라우드, 5G, 서버, 전산망, 전산시스템  
관련 언어: C, C++, Python, Java  
자격증목록: 정보처리기사, 정보통신산업기사, 전자계산기기사, 정보관리기술사  
적성목록: 전기, 전자, 통신 관련 전문 지식과 컴퓨터 네트워크, 하드웨어 및 소프트웨어 기술을 논리적이고 체계적으로 정리하는 능력이 필요하며, 네트워크 장비의 입체적 구성이 요구됩니다.

직업 명: 데이터베이스관리자  
하는 일 요약: 데이터베이스관리자는 데이터를 체계적으로 수집, 정리, 가공하여 데이터베이스를 구축하고 관리하며, 사용자 권한 및 접근을 관리하고 시스템 장애 발생 시 신속히 복구합니다. 데이터 백업 및 검토를 통해 데이터 손실을 예방하며, 고객의 요구에 맞는 자료를 수집하고 분석합니다.  
흥미 목록: 최신 기술 정보와 데이터 관리 방법을 탐구하는 것을 좋아하는 사람, 팀과 협력하여 일하는 것을 선호하는 사람에게 적합합니다.  
관련직업명: 시스템엔지니어, 데이터마이너  
일가정균형: 보통이상  
평균 연봉: 4,600만 원  
취업 방법: 대량의 데이터를 관리하는 기업이나 공공기관에 공개 채용 또는 특별 채용을 통해 취업하며, 정보통신공학 전공이 유리합니다.  
업무환경: 앉아서 근무하며 이메일 사용 빈도가 높고, 다른 사람들과의 소통 및 조율이 중요합니다.  
핵심능력목록: 수리·논리력, 전산, 설치, 기술 설계, 문제 해결 능력  
관련학과목록: 전자공학과, 정보통신공학과, 컴퓨터공학과  
태그목록: IT, DB관리자, 빅데이터, 개발자, 기술자  
관련 언어: SQL, Python, Java  
자격증목록: 정보처리기사, SQL, 데이터아키텍처, 정보관리기술사  
적성목록: 데이터베이스의 설계 및 관리의 목적을 이해하고 안정적이며 빠른 시스템을 구축할 수 있는 수리·논리력이 필요합니다.

직업 명: 정보보호전문가  
하는 일 요약: 정보보호전문가는 정보시스템의 보안 정책을 세우고, 시스템 운영을 통제하며, 침입자의 공격에 신속하게 대응하여 시스템을 보호하는 역할을 합니다. 이들은 해킹 및 바이러스 공격을 예방하고 방어하며, 정보가 손상될 경우 신속하게 복구하고 새로운 보안 방법을 마련합니다.  
흥미 목록: 최신 IT 기술과 보안 기술을 탐구하는 것을 즐기고, 기업의 담당자나 임원들을 설득하는 과정을 좋아하는 사람에게 적합합니다.  
관련직업명: 컴퓨터보안전문가, 산업보안전문가  
일가정균형: 보통이상  
평균 연봉: 3,800만 원  
취업 방법: 정보보안업체, 컴퓨터바이러스 백신개발업체, 대기업의 데이터베이스 관리 부서 및 공공기관에서 정보보호전문가로 취업. 정보보호학, 정보통신학, 컴퓨터공학 전공이 유리함.  
업무환경: 주로 앉아서 근무하며, 이메일 및 문서 작업이 많고, 재택근무 가능성이 있음.  
핵심능력목록: 수리·논리력, 공간지각력, 기억력  
관련학과목록: 정보보호학과, 컴퓨터공학과, 정보통신공학과  
태그목록: 해커, 크래커, 화이트해커, IT, 보안, 클라우드  
관련 언어: C, C++, Python, Java  
자격증목록: 정보처리기사, 정보보안기사, 정보시스템감리사, 정보시스템감사사(CISA), 정보관리기술사  
적성목록: 체계적이고 논리적인 수리·논리력이 필요하며, 해킹 및 바이러스 분석을 위한 탐구심이 요구됨.

직업 명: 시스템엔지니어  
하는 일 요약: 시스템엔지니어는 정보 기술의 기술적 사항을 분석하고 설계하여 사용 용도에 맞는 안정된 정보시스템을 구축합니다. 이들은 기존 시스템의 문제점을 파악하고, 고객의 요구 사항을 분석하여 필요한 시스템의 성능과 기능을 결정하며, 데이터 처리 문제를 검토합니다.  
흥미 목록: 기술 관련 최신 정보를 탐구하며, 다양한 시스템 관계자와 원활한 의사소통 및 토론을 즐기는 사람에게 적합합니다.  
관련직업명: 시스템운영관리자, 컴퓨터하드웨어 기술자 및 연구원, 시스템소프트웨어개발자  
일가정균형: 보통이상  
평균 연봉: 3,730만 원 (2021년 기준, 시스템소프트웨어개발자 평균)  
취업 방법: 소프트웨어 개발 및 유지·운영 업체, 대기업 정보시스템 구축 부서, 공공기관 정보화 부서 등에서 취업하며, 정보통신학이나 컴퓨터공학 전공이 유리합니다.  
업무환경: 앉아서 근무하며, 이메일 사용 빈도가 높고, 팀워크와 상호작용이 중요한 실내 근무 환경입니다.  
핵심능력목록: 기술 설계, 전산, 기술 분석, 문제 해결, 논리적 분석  
관련학과목록: 시스템경영공학과, 컴퓨터응용기계과, 스마트정보과, 시스템공학과, 컴퓨터공학과  
태그목록: 기술자, 개발자, 클라우드, IT, ICT, 컴퓨터, 코딩  
관련 언어: C, C++, Java, Python  
자격증목록: 컴퓨터시스템응용기술사, 정보관리기술사, 정보처리기사, 전자계산기기사가 포함됩니다.  
적성목록: 시스템 장애 원인 파악 및 문제 해결을 위한 수리·논리력이 필요합니다.  

직업 명: 웹디자이너  
하는 일 요약: 웹디자이너는 웹사이트의 전체적인 디자인과 구조를 계획하고 제작하며, 사용자가 알기 쉽고 편리하게 이용할 수 있도록 웹페이지의 문자, 이미지, 동영상 등을 재가공하는 작업을 수행합니다. 또한, HTML5, CSS, Javascript 등 다양한 기술을 활용하여 웹사이트에 애니메이션이나 특정 효과를 구현합니다.  
흥미 목록: 사람들과 소통하며 협력하는 것을 좋아하고, 창의적인 문제 해결 방식에 관심이 있는 사람에게 적합합니다.  
관련직업명: 컴퓨터그래픽디자이너, 웹마스터  
일가정균형: 매우 좋음  
평균 연봉: 3,522만 원  
취업 방법: 전문대학이나 대학교의 디자인 관련 전공 졸업, 웹 전문 교육기관에서 교육 이수 후 실무 경험을 쌓아 취업 가능.  
업무환경: 재택근무 가능, 주로 앉아서 근무하며 이메일과 문서 작성이 빈번함, 실내 근무가 주를 이룸.  
핵심능력목록: 예술시각능력, 창의력  
관련학과목록: 멀티미디어과, 산업디자인과, 시각디자인과, 그래픽디자인과  
태그목록: 웹디자인, 웹개발, 홈페이지, 웹사이트, CSS, 디자이너  
관련 언어: HTML, CSS, JavaScript, JSP, ASP, XML  
자격증목록: 웹디자인기능사, 컴퓨터그래픽스운용기능사  
적성목록: 디자인 감각, 색채 감각이 뛰어나고, 창의적인 아이디어를 발휘할 수 있는 능력이 필요합니다.

직업 명: IT컨설턴트  
하는 일 요약: IT컨설턴트는 기업의 인적, 물적 자원 관련 자료를 수집하고 분석하여 시스템 구축에 대한 전문적인 조언을 제공합니다. 기존 정보시스템의 평가 및 효율성 분석을 수행하며, 새로운 시스템 개발 시 필요한 구성 방안과 예산을 설계합니다. 또한, 정보시스템 개발 프로젝트의 진행을 감리하고, 기업의 업무 효율성과 생산성을 높일 수 있도록 시스템 운영 방법에 대한 전문적 조언을 합니다.  
흥미 목록: 의사소통 능력이 뛰어나고 팀원들과 원만하게 지낼 수 있는 사람에게 적합하며, 높은 집중력과 인내심을 가진 사람에게도 적합합니다.  
관련직업명: 정보보호전문가, 웹접근성컨설턴트, 컴퓨터시스템감리전문가, 정보통신컨설턴트  
일가정균형: 보통이상  
평균 연봉: 4,750만 원  
취업 방법: 정보화전략컨설팅 업체 등에서 공개 채용이나 특별 채용을 통해 취업하며, 대학 졸업 이상의 학력이 요구됩니다.  
업무환경: 주로 앉아서 근무하며 이메일 사용이 빈번하고, 팀 단위로 업무를 진행합니다. 갈등 상황이 발생할 수 있으며, 사람들 앞에서 발표하는 경우도 많습니다.  
핵심능력목록: 인적자원 관리, 물적자원 관리, 조직체계의 분석 및 평가, 재정 관리, 협상, 설득 능력  
관련학과목록: 인터넷정보학과, 정보통신과, 정보통신공학과, 경영정보과, 경영학과  
태그목록: 전산감리, 인터넷전략계획, ISP, 웹컨설팅, ISMP, 컴퓨터, 클라우드, IT전문가, 감리원  
관련 언어: C, C++, Java, Python  
자격증목록: 정보관리기술사, 정보처리기사, 정보통신기사, 정보시스템감리사, 정보기술프로젝트관리전문가(IT-PMP)  
적성목록: 수리·논리력, 전문 지식과 법, 제도에 대한 폭넓은 지식을 논리적으로 정리할 수 있는 능력 필요.  

직업 명: 통신망설계운영기술자  
하는 일 요약: 통신망설계운영기술자는 통신망의 효율성을 극대화하고 품질을 향상시키기 위해 통신망을 설계하고 운영하는 일을 수행합니다. 이를 위해 차세대 통신기술 및 서비스에 대한 계획을 수립하고, 중장기 전략을 마련하여 통신망의 안정성을 높이며 장애 복구 대책을 마련합니다.  
흥미 목록: 최신 통신기술을 탐구하는 것을 즐기며, 다양한 장비를 다루는 것을 좋아하는 사람에게 적합합니다.  
관련직업명: 통신공학 기술자 및 연구원, 통신엔지니어, 무선주파수(RF)엔지니어 등  
일가정균형: 좋음  
평균 연봉: 4,400만 원  
취업 방법: 공개 채용이나 특별 채용을 통해 관련 업체의 연구개발부서에 취업할 수 있으며, 정보통신공학 전공과 대학 졸업 이상의 학력이 필요합니다.  
업무환경: 고지대 작업, 이메일 및 전화 대화가 빈번하며, 앉아서 근무하는 경우가 많고 실외 근무도 포함됩니다.  
핵심능력목록: 수리·논리력, 공간지각력  
관련학과목록: 컴퓨터공학과, 정보통신공학과, 전자공학과 등  
태그목록: 네트워크, 개발자, IT, 기술자, 컴퓨터, 정보통신  
관련 언어: C, C++, Python, Java  
자격증목록: 무선설비기사, 전파전자통신기사, 정보통신산업기사 등  
적성목록: 수리·논리력과 공간지각력이 요구되며, 통신망 구성 장치를 입체적으로 상상하고 분석할 수 있는 능력이 필요합니다.  

직업 명: 무선주파수(RF)엔지니어  
하는 일 요약: 무선주파수(RF)엔지니어는 무선통신 장비를 연구, 개발 및 설계하며, 시장 조사와 기술 분석을 통해 새로운 기능과 성능을 갖춘 제품을 기획하고 개발합니다. 또한, 개발한 장비의 성능과 품질을 검사하고 결함 원인을 분석하여 해결책을 제시합니다.  
흥미 목록: 무선주파수를 효율적으로 처리하는 장비 연구에 관심이 있는 사람, 통신장비나 기계 다루기를 좋아하는 사람에게 적합함.  
관련직업명: 통신엔지니어, 네트워크엔지니어, 통신망설계운영기술자, 통신공학 기술자 및 연구원, 사물 인터넷 전문가  
일가정균형: 좋음  
평균 연봉: 4,325만 원 (2021년 기준, 관련 직업 통신기술개발자 기준)  
취업 방법: 이동통신서비스업체, 휴대폰 제조업체, 방송국 등에서 공개 채용이나 특별 채용으로 취업 가능. 연구개발 분야는 대학교 졸업 이상의 학력이 요구됨.  
업무환경: 주로 실내에서 근무하며, 이메일 및 전화 대화가 빈번하고, 팀워크가 중요한 업무 환경임.  
핵심능력목록: 수리·논리력, 공간지각력  
관련학과목록: 전자공학과, 정보통신공학과, 전기전자공학과  
태그목록: 사물인터넷, 4차산업, 정보통신, IT, 무선, 라디오, 무선통신, 무전기  
관련 언어: C, C++, Python, Java  
자격증목록: 무선설비산업기사, 무선설비기사, RFID기술자격검정  
적성목록: 새로운 기술에 대한 정보 수집 및 문제 해결 능력, 수리·논리력, 공간지각력이 요구됨.

직업 명: 시스템소프트웨어개발자  
하는 일 요약: 시스템소프트웨어개발자는 오퍼레이팅 시스템 소프트웨어를 연구, 개발, 설계하며, 시장 조사와 기술 분석을 통해 새로운 시스템소프트웨어를 기획하고 개발합니다. 개발된 소프트웨어는 설치 및 시험 운영을 통해 기능과 성능을 평가하며, 사용자 교육과 기술 조언도 수행합니다.  
흥미 목록: 시스템 운영체제 및 소프트웨어 개발에 대한 탐구와 프로그래밍을 논리적으로 수행하는 것을 선호하는 사람에게 적합합니다.  
관련직업명: 메카트로닉스공학기술자, 컴퓨터하드웨어 기술자 및 연구원, 의료정보시스템개발자, 무인항공기시스템개발자, 모바일앱개발자, 고객관리시스템(CRM)전문가, 클라우드 시스템 엔지니어  
일가정균형: 좋음  
평균 연봉: 3,730만 원  
취업 방법: 시스템소프트웨어개발업체, 응용소프트웨어개발업체 등에서 공개 채용 또는 특별 채용을 통해 취업하며, 전문대학 이상의 학력이 필요합니다.  
업무환경: 주로 앉아서 근무하며 이메일 사용이 많고, 팀과의 협업이 중요합니다. 재택근무도 가능하며 실내에서 주로 근무합니다.  
핵심능력목록: 수리·논리력  
관련학과목록: 컴퓨터공학과, 시스템공학과, 컴퓨터응용기계과, 정보통신공학과, 소프트웨어공학과  
태그목록: 수리·논리력  
관련 언어: C, C++, Java, Python  
자격증목록: 전자계산기기사, 정보처리기사, 마이크로소프트 인증 전문가 자격증(MCP), 오라클 자격인증  
적성목록: 컴퓨터 시스템에 대한 전문 지식과 프로그래밍 능력을 바탕으로 한 수리·논리력이 필요합니다.  

직업 명: 가상현실전문가  
하는 일 요약: 가상현실전문가는 3D 모델링 등의 기술을 이용해 가상의 시공간에서 가상 시스템을 개발하고, 사용자의 요구를 분석하여 개발 방향을 설정합니다. 신제품 기획안을 바탕으로 3차원 컴퓨터 그래픽 제어 기술을 활용하여 프로그래밍하고, 디자인 감각으로 사용자가 실제감을 느낄 수 있도록 가상현실 시스템을 디자인합니다.  
흥미 목록: 논리적이고 합리적인 사고를 하는 사람에게 적합하며, 현실적이고 실제적인 것에 영향을 많이 받는 사람에게도 적합합니다.  
관련직업명: 과학용소프트웨어개발자, 산업용소프트웨어개발자, 교육용소프트웨어개발자  
일가정균형: 보통이상  
평균 연봉: 3,730만 원  
취업 방법: 가상현실을 다루는 게임이나 영화 관련 업체, 산업현장 교육훈련 업체나 관련 사설 연구소로 취업하며, 전자공학과, 정보통신공학과 등 관련 전공 졸업이 유리합니다.  
업무환경: 주로 앉아서 근무하며, 재택근무가 가능하고, 이메일 사용이 빈번합니다. 마감시간을 준수해야 하며, 실내에서 근무합니다.  
핵심능력목록: 기술 분석, 전산, 기술 설계, 조직체계의 분석 및 평가, 추리력  
관련학과목록: 컴퓨터공학과, 컴퓨터과학과, 컴퓨터디자인학과, 컴퓨터응용기계과, 컴퓨터소프트웨어과  
태그목록: 3차원모델링, 3D, 가상현실모델링언어  
관련 언어: C, C++, Python, Java  
자격증목록: 시각디자인기사, 시각디자인산업기사, 정보처리기사, 컴퓨터그래픽스운용기능사  
적성목록: 문제 해결의 과정을 단계별로 수행할 수 있는 수리·논리력이 필요합니다.

직업 명: 통신설비설치 및 수리원  
하는 일 요약: 통신설비설치 및 수리원은 유선전화, 휴대폰, 무선통신기기 등의 통신장비를 설치하고 수리하는 역할을 수행합니다. 통신장비 설치 위치를 확인하고, 설계도에 따라 장비를 설치한 후, 정상 작동 여부를 점검하며 고장 발생 시 수리합니다.  
흥미 목록: 신체적인 활동을 선호하며, 통신장비에 대한 관심과 호기심이 많은 사람에게 적합합니다.  
관련직업명: 유선통신장비설치 및 수리원, 무선통신장비설치 및 수리원  
일가정균형: 보통이상  
평균 연봉: 3,500만 원  
취업 방법: 공개 채용이나 교육기관의 소개를 통해 통신업체나 초고속망 설치업체에 취업할 수 있습니다.  
업무환경: 고지대 작업, 극단적인 조명, 위험한 상태 노출 등 다양한 환경에서 업무를 수행해야 하며, 신체적인 활동이 많이 요구됩니다.  
핵심능력목록: 손재능, 유연성 및 균형, 고장 발견·수리 능력  
관련학과목록: 전기전자과, 정보통신과, 전자과  
태그목록: 전자통신, 전기  
관련언어: N/A  
자격증목록: 정보통신기사, 정보통신기술사, 정보통신산업기사  
적성목록: 도구의 특성을 알고 용도에 맞게 사용할 수 있는 손재능이 필요하며, 통신장비의 설치와 수리를 위해 신체적 능력이 중요합니다.  

직업 명: 베타테스터  
하는 일 요약: 베타테스터는 소프트웨어나 하드웨어 제품의 결함을 검사하고 오류를 파악하여 해결 방안을 제시하는 역할을 합니다. 게임 베타테스터는 게임 출시 전 사용자 테스트를 통해 문제점을 찾아내고, 제품의 품질을 높이는 데 기여합니다.  
흥미 목록: 컴퓨터 및 프로그래밍에 대한 관심이 많고, 문제를 발견하고 해결하는 것을 좋아하는 사람에게 적합합니다.  
관련직업명: 베타테스트 엔지니어, 게임베타테스터  
일가정균형: 좋음  
평균 연봉: 4,144만 원  
취업 방법: 공개 채용 또는 개인적 소개를 통해 컴퓨터 관련 업체 및 게임/소프트웨어업체에 취업할 수 있습니다.  
업무환경: 이메일 사용, 문서 주고받기, 앉아서 근무하는 시간이 많으며, 갈등 상황이나 반복적인 신체행동이 발생할 수 있습니다.  
핵심능력목록: 수리·논리력  
관련학과목록: 게임콘텐츠과, 컴퓨터소프트웨어과, 컴퓨터공학과, 컴퓨터과학과, 벤처창업학과  
태그목록: 게임, 컴퓨터, 소프트웨어, IT  
관련 언어: 없음  
자격증목록: SW테스트 전문가, 정보처리기사  
적성목록: 문제 해결을 위한 논리적 사고와 컴퓨터의 구조 및 프로그래밍에 대한 이해가 필요합니다.

직업 명: 블록체인 전문가  
하는 일 요약: 블록체인 전문가는 블록체인 기술을 활용해 거래 내용을 공개적으로 기록하고 여러 대의 컴퓨터에 복제, 저장하는 소프트웨어를 설계 및 개발합니다. 또한, 블록체인 기술을 기반으로 암호화폐를 개발하고, 이를 실생활에 적용할 수 있도록 소프트웨어를 개선합니다.  
흥미 목록: 새로운 것을 탐구하고 분석하는 것을 즐기며, 논리적이고 합리적으로 사고하는 사람에게 적합합니다. 소프트웨어 설계 및 개발에 관심이 있고, 세심하고 꼼꼼한 성격이 요구됩니다.  
관련직업명: 블록체인 소프트웨어 개발자, 암호학자, 정보 보호 전문가  
일가정균형: 보통이상  
평균 연봉: 정보 없음  
취업 방법: 블록체인 기술을 개발하는 소프트웨어 회사, 금융기관, 블록체인 기술을 활용하는 민간기업 및 공공기관에 취업할 수 있습니다.  
업무환경: 정보 없음  
핵심능력목록: 수리·논리력, 공간지각력  
관련학과목록: 사이버국방학과, 소프트웨어공학과, 정보보호학과, 정보통신공학과, 컴퓨터공학과, 컴퓨터과학과, 경제학과  
태그목록: 4차산업혁명, 핀테크, 블록체인, 가상화폐  
관련 언어: 정보 없음  
자격증목록: 정보 없음  
적성목록: 프로그래밍에 대한 이해를 바탕으로 수리·논리력이 필요하며, 블록체인 기술 설계 및 개발에 필요한 공간지각력이 요구됩니다.  

직업 명: 디지털 포렌식 수사관  
하는 일 요약: 디지털 포렌식 수사관은 PC, 노트북, 휴대폰 등 다양한 저장 매체와 인터넷 상의 디지털 정보를 수집하고 분석하여 범죄 단서를 찾는 역할을 수행합니다. 범죄자가 숨긴 데이터를 복구하여 법정에 제출할 수 있는 증거로 만들어 신뢰성을 확보하며, 확보한 자료는 법정에서 증거로 인정받을 수 있도록 유지 및 보관합니다.  
흥미 목록: 디지털 정보와 범죄의 연관성을 탐구하고, 논리적이고 합리적인 사고를 통해 문제를 해결하는 것에 관심이 있는 사람에게 적합하며, 사명감과 타인의 감정을 이해하고 봉사하는 마음가짐이 필요한 직업입니다.  
관련직업명: 디지털포렌식전문가, 사이버포렌식전문가  
일가정균형: 정보 없음  
평균 연봉: 정보 없음  
취업 방법: 검찰청, 경찰청, 해양경찰청, 관세청, 국방부 등 국가기관, 기업의 법무팀, 회계법인, 법무법인 등에 취업할 수 있으며, 연구소에서 일하기 위해서는 석박사 이상의 학력이 필요할 수 있습니다.  
업무환경: 정보 없음  
핵심능력목록: 자기성찰능력, 수리·논리력, 언어능력  
관련학과목록: IT융합학과, 사이버국방학과, 소프트웨어공학과, 정보보호학과, 컴퓨터공학과, 경찰행정학과  
태그목록: 디지털 포렌식, 사이버 포렌식, 디지털 자료  
관련 언어: 정보 없음  
자격증목록: 정보 없음  
적성목록: 문제 해결을 위한 자기성찰능력, 숨은 증거를 찾아내기 위한 수리·논리력, 디지털 정보 분석을 위한 언어능력 등이 필요합니다.  


직업 명: 클라우드 시스템 엔지니어  
하는 일 요약: 클라우드 시스템 엔지니어는 인터넷 서버에 프로그램을 올리고, 클라우드 환경에서 데이터를 저장하고 처리하는 기술을 개발합니다. 고객의 시스템을 분석하여 클라우드 환경으로 전환할 수 있도록 기술 지원을 제공합니다. 이들은 다양한 기기를 통해 클라우드 서비스를 이용할 수 있도록 인프라를 구축합니다.  
흥미 목록: 새로운 것에 대한 호기심과 논리적 사고를 가진 사람에게 적합하며, 자료 수집과 탐구를 즐기는 사람에게도 적합합니다.  
관련직업명: 시스템 프로그래머, 응용 프로그래머, 정보통신 엔지니어, 데이터베이스 전문가  
일가정균형: 보통이상  
평균 연봉: 정보 없음  
취업 방법: 정보통신 시스템 통합 업체, 시스템 개발 업체, 기업의 시스템 관리자, 전산직 공무원 등으로 취업할 수 있습니다.  
업무환경: 정보 없음  
핵심능력목록: 수리·논리력, 공간지각력  
관련학과목록: IT융합학과, 소프트웨어공학과, 정보통신공학과, 컴퓨터공학과  
태그목록: 컴퓨터, 클라우드 컴퓨팅  
관련 언어: 정보 없음  
자격증목록: 빅데이터분석기사  
적성목록: 컴퓨터 통신망을 체계적으로 만들기 위해 수리·논리력이 필요하며, 데이터나 프로그램의 구성을 파악하기 위한 공간지각력이 요구됩니다.

직업 명: 빅 데이터 전문가  
하는 일 요약: 빅 데이터 전문가는 대량의 데이터를 수집, 저장, 분석 및 시각화하여 사람들의 행동 및 시장의 변화를 분석하는 정보를 제공합니다. 실시간 데이터 처리와 새로운 기술 및 유행을 파악하는 역할도 포함됩니다.  
흥미 목록: 최신 경향과 정보에 대한 호기심이 많고, 방대한 데이터를 꼼꼼하게 탐구하는 것을 즐기는 사람에게 적합합니다.  
관련직업명: 컴퓨터 시스템 설계 분석가, 시스템 소프트웨어 개발자, 응용 소프트웨어 개발자  
일가정균형: 보통 이상  
평균 연봉: 4,455만 원  
취업 방법: 대기업의 빅 데이터 관리 부서, 마케팅 부서 및 데이터 분석 전문 업체에 취업. 금융, 유통, 의료 등 다양한 분야에서 활동 가능.  
업무환경: 재택근무 가능성이 높고, 주로 앉아서 근무하며 이메일을 많이 사용함. 다른 사람과의 상호작용도 필요함.  
핵심능력목록: 수리·논리력, 공간지각력  
관련학과목록: IT융합학과, 소프트웨어공학과, 정보통신공학과, 통계학과 등  
태그목록: 컴퓨터, 데이터  
관련 언어: Python, R, SQL, Java  
자격증목록: 빅데이터분석기사, 사회조사 분석사, 정보처리기사  
적성목록: 통계 이론과 복잡한 프로그램에 대한 이해력, 다양한 관점에서 문제를 의식하는 수리·논리력, 데이터 구조 이해 및 분석을 위한 공간지각력 필요.
직업 명: 사물 인터넷 전문가  
하는 일 요약: 사물 인터넷 전문가는 주변의 사람, 사물, 공간과 관련된 데이터를 인터넷으로 연결하여 새로운 정보를 생성, 수집, 공유 및 활용함으로써 편리함을 제공합니다. 이들은 사회의 안전, 복지, 교통, 환경 문제를 점검하고, 사물 인터넷 기술을 활용한 해결 방안을 모색하며, 관련 제품을 기획하거나 개발합니다.  
흥미 목록: 새로운 가치나 서비스를 창출하는 데 호기심이 많은 사람, 모험 정신이 강하고 도전적인 작업을 좋아하는 사람에게 적합합니다.  
관련직업명: 컴퓨터 프로그래머, 컴퓨터 보안 전문가, 네트워크 시스템 개발자, 통신공학 기술자, 가전제품 개발자, 사물 인터넷 표준 전문가  
일가정균형: 좋음  
평균 연봉: 정보 없음  
취업 방법: 주로 사물 인터넷 서비스 기업이나 정보 통신 관련 기업의 사물 인터넷 부서에서 기획, 개발, 영업, 홍보, 판매 등의 업무를 담당하며, 연구소나 정부 기관에서도 근무할 수 있습니다.  
업무환경: 정보 없음  
핵심능력목록: 수리·논리력, 공간지각력  
관련학과목록: 정보통신과, 컴퓨터과, 소프트웨어공학과  
태그목록: 컴퓨터, 연결  
관련 언어: 정보 없음  
자격증목록: IoT 지식 능력 검정시험  
적성목록: 공간을 구성하고 물체의 위치나 모습을 상상할 수 있는 공간지각력, 다양한 정보통신 기술을 활용하는 수리·논리력 필요  

직업 명: 데이터마이너  
하는 일 요약: 데이터마이너는 데이터를 원하는 형태로 변환하고 분석하여 필요한 정보를 찾아내며, 소프트웨어를 통해 데이터를 다양한 관점에서 분류하고 요약합니다. 데이터마이닝을 실행하기 전에 목적을 설정하고 필요한 데이터를 결정한 후, 분석을 통해 정보가 유용한지 판단하고 오류를 확인합니다.  
흥미 목록: 수학, 통계, 컴퓨터 프로그래밍에 대한 관심이 있으며 데이터를 수집하고 분석하는 것을 좋아하는 사람에게 적합합니다. 팀 단위로 일하며 의사소통 능력을 갖추고 소통을 즐기는 사람에게도 적합합니다.  
관련직업명: 빅데이터 전문가, 빅데이터분석가, 통계학연구원  
일가정균형: 보통이상  
평균 연봉: 정보 없음  
취업 방법: 일반기업 및 공공기관의 공개 채용이나 특별 채용을 통해 취업할 수 있으며, 관련 직업훈련을 받고 실무 경력을 쌓거나 정보통신공학을 전공하면 유리합니다.  
업무환경: 정보 없음  
핵심능력목록: 수리·논리력  
관련학과목록: IT융합학과, 인터넷정보학과, 컴퓨터공학과  
태그목록: 빅데이터, 4차산업, 데이터전문가, DBA, 분석가, 빅데이터전문가, 인공지능  
관련 언어: 정보 없음  
자격증목록: 정보처리기사, 정보처리산업기사, SQL, 데이터아키텍처  
적성목록: 유용한 데이터와 정보를 파악하고 분석하기 위한 수리·논리력이 필요함.  

직업 명: 웹접근성컨설턴트  
하는 일 요약: 웹접근성컨설턴트는 웹사이트가 모든 사용자가 손쉽게 접근할 수 있도록 접근성 기준을 준수하고 있는지를 평가하며, 기업이나 기관에 전문적인 조언과 지원을 제공합니다. 콘텐츠의 분석, 설계, 개발, 테스트, 실행 과정에서 웹 접근성에 대한 교육 및 진단 서비스를 제공하고, 관련 가이드라인과 표준 지침을 설명합니다. 또한 최종 콘텐츠를 검토하고 웹 접근성 품질 마크 획득을 지원합니다.  
흥미 목록: 웹 접근성 분석 결과를 체계적으로 설명할 수 있는 능력과 팀과의 원활한 소통이 중요한 역할을 하며, 콘텐츠의 장단점을 파악하여 효과적인 대안을 제시할 수 있는 능력이 요구됩니다.  
관련직업명: IT컨설턴트, 정보통신컨설턴트  
일가정균형: 매우 좋음  
평균 연봉: 정보 없음  
취업 방법: 공개 채용이나 개인적 소개를 통해 웹 접근성 전문업체나 IT개발업체의 웹 표준 업무 담당으로 취업하며, 요구되는 학력 조건을 확인하고 준비하는 것이 중요합니다.  
업무환경: 정보 없음  
핵심능력목록: 수리·논리력  
관련학과목록: 인터넷정보학과, IT융합학과, 컴퓨터공학과  
태그목록: 웹접근성인증, 장애인, 웹표준, 접근성, 장애인차별금지법, IT컨설팅, IT전문가, IT  
관련 언어: 정보 없음  
자격증목록: 정보처리기사  
적성목록: 웹 접근성 및 웹 표준화 가이드에 따라 웹사이트의 구축 여부를 논리적으로 평가할 수 있는 수리·논리력이 필요합니다.

직업 명: 모바일앱개발자  
하는 일 요약: 모바일앱개발자는 스마트폰 및 태블릿PC에서 사용되는 애플리케이션을 개발하고 수정하며, 사용자의 요구에 맞는 기능을 기획하고 구현합니다. 또한, 모바일 운영체제의 기술 변화를 검토하고, 사용자 교육 및 시스템 구성을 통해 고객의 요구를 충족시킵니다.  
흥미 목록: 최신 모바일 기술과 소스 코드 탐구에 흥미가 있는 사람에게 적합하며, 체계적이고 반복적인 프로그래밍 작업을 즐길 수 있는 성격이 필요합니다.  
관련직업명: 시스템소프트웨어개발자, 컴퓨터하드웨어 기술자, 보건의료정보관리자, 고객관리시스템(CRM) 전문가, 클라우드 시스템 엔지니어  
일가정균형: 보통 이상  
평균 연봉: 4,000만 원  
취업 방법: 공개 채용이나 특별 채용을 통해 모바일소프트웨어개발 전문업체, IT개발 전문업체에 취업할 수 있습니다.  
업무환경: 주로 재택근무 가능, 앉아서 근무하며 이메일 사용 빈도가 높고, 실내 근무가 주를 이루며 다른 사람들과의 상호작용이 필요합니다.  
핵심능력목록: 수리·논리력, 창의력  
관련학과목록: 컴퓨터공학과, 소프트웨어공학과, 게임공학과, 정보통신과  
태그목록: 프로그래머, 소프트웨어, 애플개발자, 안드로이드개발자, 앱개발, 개발자, 모바일개발자  
관련 언어: Java, Swift, Kotlin, C#  
자격증목록: 정보처리기사, 전자계산기기사, 마이크로소프트 인증 전문가 자격증(MCP), 오라클 자격인증제도  
적성목록: 고객의 요구 사항을 논리적으로 정리하고 프로그래밍 언어로 구현할 수 있는 수리·논리력이 필요합니다.
</job summary>

추천 직업은 최대 3개까지 제공하며, 직업 추천은 사용자의 적성과 관심사를 기반으로 합니다.
</prompt>
"""),
    MessagesPlaceholder(variable_name="history"),
    ("human", "<source>{source}</source>\nuserInput: {human_input}"),
])

def make_source(data: Dict[str, Any]) -> str:
    result = format_docs(ensemble_retriever.invoke(data["human_input"]))
    return result

# Create chain
chain = (
    RunnablePassthrough()
    .assign(source=make_source) 
    | prompt 
    | llm 
)

chain_with_history = RunnableWithMessageHistory(
    chain,
    create_session_factory("chat_histories"),
    input_messages_key="human_input",
    history_messages_key="history",
).with_types(input_type=InputChat)

